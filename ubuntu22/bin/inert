#!/bin/bash

if [ -z "$1" ]
  then
    echo "inert -a ssh"
    exit
fi

while getopts "a:" opt; do
  case $opt in
    a) app+=("$OPTARG");;
    *) echo 'inert -a ssh' && exit 0 ;;
  esac
done
shift $((OPTIND -1))


sshInit(){
  key=/root/.ssh/id_rsa
  if [ ! -f "$key" ]; then
    ssh-keygen -q -t rsa -N '' -f "$HOME/.ssh/id_rsa"
  fi
  python3 /var/inert/air/ssh.py
  bash /var/inert/scripts/key_exchange.sh
}

for a in "${app[@]}"; do
  case $a in
    ssh)
      sshInit
      ;;
  esac
done

